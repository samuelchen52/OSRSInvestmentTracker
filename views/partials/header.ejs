<!DOCTYPE html>
<html> 
<head>
<title>GE Tracker</title>

<!-- bootstrap js-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script src = "/bootstrap.js"> </script>
<!-- bootstrap css -->
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel = "stylesheet" href = "/bootstrap.css">

<!-- chart.js -->
<script src="/Chart.js"></script>
<link rel = "stylesheet" href = "/Chart.css">

<link rel = "stylesheet" href = "/app.css">

</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-light">
	  <a class="navbar-brand ml-4" href="/">GETracker</a>
	  <div class="collapse navbar-collapse">
	    <ul class="navbar-nav mr-auto">
	     	
	    </ul>
	    <span class="navbar-text mr-4">
	    	<a href = "/about"> about </a>
	    </span>
	    <span class="navbar-text mr-4">
	    	<% if (user !== null){ %>
				<form action = "/logout" method = POST>
					<button class = "btn btn-dark" type = "submit"> logout </button>
				</form>
				<% } else {%>
				<a href = "/login" > login </a>
			<% }%>
	    </span>
	  </div>
	</nav>

	<% if (user !== null){ %>
		<% var profits= []; var losses = []; %>
		<% for (var i = 0; i < user.investments.length; i ++) { %>
			<% if (user.investments[i].pricePerItemInvested <= user.investments[i].currentPricePerItem) { %>
			<% profits.push(user.investments[i]); %>
			<% } else { %>
			<% losses.push(user.investments[i]); %>
			<% } %>
		<% } %>
		<div id = "inthegreen">
			<% for (var i = 0; i < profits.length; i ++) { %>
				<div class = "container greeninvestment">
					<div class = "row justify-content-between">
						<div class = "col-4">
							x<%=profits[i].numInvested%>
							<img src = "/images/small/<%=profits[i].id%>.gif" title = "<%=profits[i].name%>">
							<%= Math.floor( (new Date() - profits[i].dateInvested) / (1000 * 60 * 60 * 24) )%> days ago
						</div>
						<div class = "col-8">
							<div>
								gp ea. <%=profits[i].pricePerItemInvested%> -> <%=profits[i].currentPricePerItem%>
								total <%=profits[i].pricePerItemInvested * profits[i].numInvested%> -> <%=profits[i].currentPricePerItem * profits[i].numInvested%>
								gains: <%=profits[i].currentPricePerItem * profits[i].numInvested - profits[i].pricePerItemInvested * profits[i].numInvested%>
							</div>
						</div>
					</div>
				</div>
			<% } %>
		</div>
		<div id = "inthered">
			<% for (var i = 0; i < losses.length; i ++) { %>
				<div class = "container redinvestment">
					<div class = "row justify-content-between">
						<div class = "col-4">
							x<%=losses[i].numInvested%>
							<img src = "/images/small/<%=losses[i].id%>.gif" title = "<%=losses[i].name%>">
							<%= Math.floor( (new Date() - profits[i].dateInvested) / (1000 * 60 * 60 * 24) )%> days ago
						</div>
						<div class = "col-8">
							<div>
								gp ea. <%=losses[i].pricePerItemInvested%> -> <%=losses[i].currentPricePerItem%>
								total <%=losses[i].pricePerItemInvested * losses[i].numInvested%> -> <%=losses[i].currentPricePerItem * losses[i].numInvested%>
								losses: <%=losses[i].currentPricePerItem * losses[i].numInvested - losses[i].pricePerItemInvested * losses[i].numInvested%>
							</div>
						</div>
					</div>
				</div>
			<% } %>
		</div>
	<% }%>

	<script>
		if ($(".greeninvestment").length > 0)
		{
			$("#inthegreen").css("background-image", "linear-gradient(#1fcf4e, #b2edc2, white)");
		}
		if ($(".redinvestment").length > 0)
		{
			$("#inthered").css("background-image", "linear-gradient(white, #eb918a, #e62315)");
		}


	</script>


	
